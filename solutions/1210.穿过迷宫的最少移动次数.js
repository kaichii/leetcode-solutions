/*
 * @lc app=leetcode.cn id=1210 lang=javascript
 *
 * [1210] ç©¿è¿‡è¿·å®«çš„æœ€å°‘ç§»åŠ¨æ¬¡æ•°
 *
 * https://leetcode.cn/problems/minimum-moves-to-reach-target-with-rotations/description/
 *
 * algorithms
 * Hard (64.36%)
 * Likes:    128
 * Dislikes: 0
 * Total Accepted:    14.5K
 * Total Submissions: 22.6K
 * Testcase Example:  '[[0,0,0,0,0,1],[1,1,0,0,1,0],[0,0,0,0,1,1],[0,0,1,0,1,0],[0,1,1,0,0,0],[0,1,1,0,0,0]]\r'
 *
 * ä½ è¿˜è®°å¾—é‚£æ¡é£é¡å…¨çƒçš„è´ªåƒè›‡å—ï¼Ÿ
 *
 * æˆ‘ä»¬åœ¨ä¸€ä¸ªÂ n*nÂ çš„ç½‘æ ¼ä¸Šæ„å»ºäº†æ–°çš„è¿·å®«åœ°å›¾ï¼Œè›‡çš„é•¿åº¦ä¸º 2ï¼Œä¹Ÿå°±æ˜¯è¯´å®ƒä¼šå å»ä¸¤ä¸ªå•å…ƒæ ¼ã€‚è›‡ä¼šä»å·¦ä¸Šè§’ï¼ˆ(0, 0)Â å’ŒÂ (0,
 * 1)ï¼‰å¼€å§‹ç§»åŠ¨ã€‚æˆ‘ä»¬ç”¨ 0 è¡¨ç¤ºç©ºå•å…ƒæ ¼ï¼Œç”¨ 1 è¡¨ç¤ºéšœç¢ç‰©ã€‚è›‡éœ€è¦ç§»åŠ¨åˆ°è¿·å®«çš„å³ä¸‹è§’ï¼ˆ(n-1, n-2)Â å’ŒÂ (n-1, n-1)ï¼‰ã€‚
 *
 * æ¯æ¬¡ç§»åŠ¨ï¼Œè›‡å¯ä»¥è¿™æ ·èµ°ï¼š
 *
 *
 * å¦‚æœæ²¡æœ‰éšœç¢ï¼Œåˆ™å‘å³ç§»åŠ¨ä¸€ä¸ªå•å…ƒæ ¼ã€‚å¹¶ä»ç„¶ä¿æŒèº«ä½“çš„æ°´å¹³ï¼ç«–ç›´çŠ¶æ€ã€‚
 * å¦‚æœæ²¡æœ‰éšœç¢ï¼Œåˆ™å‘ä¸‹ç§»åŠ¨ä¸€ä¸ªå•å…ƒæ ¼ã€‚å¹¶ä»ç„¶ä¿æŒèº«ä½“çš„æ°´å¹³ï¼ç«–ç›´çŠ¶æ€ã€‚
 * å¦‚æœå®ƒå¤„äºæ°´å¹³çŠ¶æ€å¹¶ä¸”å…¶ä¸‹é¢çš„ä¸¤ä¸ªå•å…ƒéƒ½æ˜¯ç©ºçš„ï¼Œå°±é¡ºæ—¶é’ˆæ—‹è½¬ 90 åº¦ã€‚è›‡ä»ï¼ˆ(r, c)ã€(r, c+1)ï¼‰ç§»åŠ¨åˆ° ï¼ˆ(r, c)ã€(r+1,
 * c)ï¼‰ã€‚
 *
 * å¦‚æœå®ƒå¤„äºç«–ç›´çŠ¶æ€å¹¶ä¸”å…¶å³é¢çš„ä¸¤ä¸ªå•å…ƒéƒ½æ˜¯ç©ºçš„ï¼Œå°±é€†æ—¶é’ˆæ—‹è½¬ 90 åº¦ã€‚è›‡ä»ï¼ˆ(r, c)ã€(r+1, c)ï¼‰ç§»åŠ¨åˆ°ï¼ˆ(r, c)ã€(r,
 * c+1)ï¼‰ã€‚
 *
 *
 *
 * è¿”å›è›‡æŠµè¾¾ç›®çš„åœ°æ‰€éœ€çš„æœ€å°‘ç§»åŠ¨æ¬¡æ•°ã€‚
 *
 * å¦‚æœæ— æ³•åˆ°è¾¾ç›®çš„åœ°ï¼Œè¯·è¿”å›Â -1ã€‚
 *
 *
 *
 * ç¤ºä¾‹ 1ï¼š
 *
 *
 *
 * è¾“å…¥ï¼šgrid = [[0,0,0,0,0,1],
 * â               [1,1,0,0,1,0],
 * [0,0,0,0,1,1],
 * [0,0,1,0,1,0],
 * [0,1,1,0,0,0],
 * [0,1,1,0,0,0]]
 * è¾“å‡ºï¼š11
 * è§£é‡Šï¼š
 * ä¸€ç§å¯èƒ½çš„è§£å†³æ–¹æ¡ˆæ˜¯ [å³, å³, é¡ºæ—¶é’ˆæ—‹è½¬, å³, ä¸‹, ä¸‹, ä¸‹, ä¸‹, é€†æ—¶é’ˆæ—‹è½¬, å³, ä¸‹]ã€‚
 *
 *
 * ç¤ºä¾‹ 2ï¼š
 *
 * è¾“å…¥ï¼šgrid = [[0,0,1,1,1,1],
 * [0,0,0,0,1,1],
 * [1,1,0,0,0,1],
 * [1,1,1,0,0,1],
 * [1,1,1,0,0,1],
 * [1,1,1,0,0,0]]
 * è¾“å‡ºï¼š9
 *
 *
 *
 *
 * æç¤ºï¼š
 *
 *
 * 2 <= n <= 100
 * 0 <= grid[i][j] <= 1
 * è›‡ä¿è¯ä»ç©ºå•å…ƒæ ¼å¼€å§‹å‡ºå‘ã€‚
 *
 *
 */

// @lc code=start
/**
 * @param {number[][]} grid
 * @return {number}
 */
var minimumMoves = function (grid) {
  /**
   * ğŸ çš„ç§»åŠ¨æ›´åƒæ˜¯ä¿„ç½—æ–¯æ–¹å—ä¸‹è½
   *
   * [x, y]: è›‡å°¾åæ ‡
   * 0: æ°´å¹³å§¿åŠ¿
   * 1: ç«–ç›´å§¿åŠ¿
   *
   * æ°´å¹³å§¿åŠ¿çš„å¯èƒ½ç§»åŠ¨æ–¹å¼
   * 1. å³ï¼šç¡®ä¿ [x, y + 2] ä¸ä¸ºéšœç¢ç‰©
   * 2. ä¸‹ï¼šç¡®ä¿ [x + 1, y], [x + 1, y + 1] ä¸ä¸ºéšœç¢ç‰©
   * 3. é¡ºæ—¶é’ˆæ—‹è½¬ï¼šç¡®ä¿ [x + 1, y], [x + 1, y + 1] ä¸ä¸ºéšœç¢ç‰©
   *
   * ç«–ç›´å§¿åŠ¿çš„å¯èƒ½ç§»åŠ¨æ–¹å¼
   * 1. å³ï¼šç¡®ä¿ [x, y + 1], [x + 1, y + 1] ä¸ä¸ºéšœç¢ç‰©
   * 2. ä¸‹ï¼šç¡®ä¿ [x + 2, y] ä¸ä¸ºéšœç¢ç‰©
   * 3. é€†æ—¶é’ˆæ—‹è½¬ï¼šç¡®ä¿ [x, y + 1], [x + 1, y + 1] ä¸ä¸ºéšœç¢ç‰©
   *
   * è›‡å°¾è¦ä» [0, 0] ç§»åŠ¨åˆ° [n - 1, n - 1] éœ€è¦ä» [n - 1, n - 2] æ°´å¹³çŠ¶æ€å³ç§»
   *
   * å‡è®¾å·²ç»ç”¨æ­¥éª¤æœ€å°‘ç§»åŠ¨åˆ° [x, y]ï¼Œä¸‹ä¸€æ­¥æœ€ä¼˜å¾€å“ªèµ°
   *
   * 1. æ°´å¹³çŠ¶æ€åˆ° [x, y]
   *  - å³: dp[0][x][y + 1] = dp[0][x][y] + 1
   *  - ä¸‹: dp[0][x + 1][y] = dp[0][x][y] + 1
   *  - é¡ºæ—¶é’ˆæ—‹è½¬: dp[1][x][y] = dp[0][x][y] + 1
   *
   * 2. ç«–ç›´çŠ¶æ€åˆ° [x, y]
   *  - å³: dp[1][x][y + 1] = dp[1][x][y] + 1
   *  - ä¸‹: dp[1][x + 1][y] = dp[1][x][y] + 1
   *  - é€†æ—¶é’ˆæ—‹è½¬: dp[0][x][y] = dp[1][x][y] + 1
   */

  const n = grid.length;

  function isBlock(i, j) {
    if (i >= n || j >= n) return true;
    return grid[i][j] !== 0;
  }

  const dp = Array.from({ length: 2 }, () =>
    Array.from({ length: n }, () => new Array(n).fill(-1))
  );

  // base case
  dp[0][0][0] = 0;

  const q = [[0, 0, 0]];

  while (q.length) {
    const [cStats, x, y] = q.shift();

    // æ°´å¹³
    if (cStats == 0) {
      // å¯ä»¥å¾€å³
      if (!isBlock(x, y + 2) && dp[cStats][x][y + 1] == -1) {
        dp[cStats][x][y + 1] = dp[cStats][x][y] + 1;

        q.push([cStats, x, y + 1]);
      }

      // å¾€ä¸‹æˆ–é¡ºæ—¶é’ˆæ—‹è½¬
      if (!isBlock(x + 1, y) && !isBlock(x + 1, y + 1)) {
        if (dp[cStats][x + 1][y] == -1) {
          dp[cStats][x + 1][y] = dp[cStats][x][y] + 1;
          q.push([cStats, x + 1, y]);
        }

        if (dp[1 - cStats][x][y] == -1) {
          dp[1 - cStats][x][y] = dp[cStats][x][y] + 1;
          q.push([1 - cStats, x, y]);
        }
      }
    }
    // ç«–ç›´
    else {
      // å¯ä»¥å¾€å³æˆ–é€†æ—¶é’ˆæ—‹è½¬
      if (!isBlock(x, y + 1) && !isBlock(x + 1, y + 1)) {
        if (dp[cStats][x][y + 1] == -1) {
          dp[cStats][x][y + 1] = dp[cStats][x][y] + 1;
          q.push([cStats, x, y + 1]);
        }

        if (dp[1 - cStats][x][y] == -1) {
          dp[1 - cStats][x][y] = dp[cStats][x][y] + 1;
          q.push([1 - cStats, x, y]);
        }
      }

      // å¾€ä¸‹
      if (!isBlock(x + 2, y) && dp[cStats][x + 1][y] == -1) {
        dp[cStats][x + 1][y] = dp[cStats][x][y] + 1;

        q.push([cStats, x + 1, y]);
      }
    }
  }

  // è›‡å°¾è¦ä» [0, 0] ç§»åŠ¨åˆ° [n - 1, n - 1] éœ€è¦ä» [n - 1, n - 2] æ°´å¹³çŠ¶æ€å³ç§»
  return dp[0][n - 1][n - 2];
};
// @lc code=end
